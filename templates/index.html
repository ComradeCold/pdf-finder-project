<!DOCTYPE html>
<html>
<head>
    <title>PDF Finder</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <style>
    .favorite-btn {
        background: none;
        border: 2px solid #ccc;
        color: #ccc;
        padding: 8px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 16px;
        margin-left: 10px;
        transition: all 0.3s ease;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .favorite-btn:hover {
        border-color: #ff6b6b;
        color: #ff6b6b;
    }

    .favorite-btn.favorited {
        background: #ff6b6b;
        border-color: #ff6b6b;
        color: white;
    }

    .pdf-link {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 5px;
        word-break: break-all;
    }

    .pdf-link a {
        flex-grow: 1;
        text-decoration: none;
        color: #007bff;
        word-break: break-all;
        overflow-wrap: break-word;
    }

    .pdf-link a:hover {
        text-decoration: underline;
    }

    .favorites-section {
        margin-top: 30px;
        padding: 20px;
        background-color: #eaf6ff;
        border-radius: 8px;
        border: 1px solid #eaf6ff;
    }

    .favorite-item {
        padding: 8px;
        margin-bottom: 5px;
        background: white;
        border-radius: 5px;
        border-left: 3px solid #fdcb6e;
        word-break: break-all;
    }

    .favorite-item a {
        text-decoration: none;
        color: #007bff;
        word-break: break-all;
    }

    .favorite-item a:hover {
        text-decoration: underline;
    }
    </style>
</head>
<body id="app-body">

<div class="mode-toggle">
    <label class="switch">
        <input type="checkbox" id="mode-toggle-checkbox">
        <span class="slider"></span>
    </label>
</div>

<div class="container">
<h1>PDF Finder</h1>

<form id="form" method="post" enctype="multipart/form-data">
    <input type="text" name="query" placeholder="Enter search term" value="{{ query }}">

    <div class="drop-zone" id="drop-zone">
        Drop image here or click to upload<br>
    </div>

    <input type="file" name="image" id="image-input" style="display:none;" accept="image/*">

    <img id="preview" class="preview" />

    <button type="submit">Search</button>
</form>

{% if pdfs %}
<div class="search-results">
    <h3>Search Results</h3>
    <div class="results-list">
        {% for pdf in pdfs %}
            <div class="pdf-link">
                <a href="{{ pdf }}" target="_blank" style="flex-grow: 1;">{{ pdf }}</a>
                <button class="favorite-btn" onclick="addFavorite('{{ pdf }}', this)">
                    â™¡
                </button>
            </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- Favorites Section -->
<div class="favorites-section">
    <h3>Your Favorites:</h3>
    {% if favorites %}
        <div class="favorites-list">
            {% for favorite in favorites %}
                <div class="favorite-item">
                    <a href="{{ favorite[0] }}" target="_blank">{{ favorite[0] }}</a>
                    <small style="color: #888; display: block;">
                        Saved: {{ favorite[1] }}
                        <button onclick="removeFavoriteFromFavoritesSection('{{ favorite[0] }}')" style="margin-left: 10px; background: #ff6b6b; color: white; border: none; padding: 2px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">Remove</button>
                    </small>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p style="color: #888; font-style: italic;">No favorites yet. Click the "Favorite" button next to PDF links to save them here.</p>
    {% endif %}
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".pdf-link a").forEach(link => {
        link.addEventListener("click", () => {
            fetch("/api/click", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ link_url: link.href })
            });
        });
    });
});
</script>

<script src="/static/js/main.js"></script>
</body>
</html>